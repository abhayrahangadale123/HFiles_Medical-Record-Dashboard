{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///E:/C_Sharp/Frontend/my-app/app/compontes/Deshbord.tsx"],"sourcesContent":[" \r\n\r\n\r\n'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport Image from 'next/image';\r\nimport { Upload, FileText, Trash2, Eye, Loader2, X } from 'lucide-react';\r\nimport toast, { Toaster } from 'react-hot-toast';\r\n\r\ninterface User {\r\n  id: number;\r\n  fullName: string;\r\n  email: string;\r\n  phone: string;\r\n  gender: string;\r\n  profileImageUrl?: string;\r\n}\r\n\r\ninterface FileRecord {\r\n  id: number;\r\n  fileName: string;\r\n  fileType: string;\r\n  storedFileName: string;\r\n  contentType: string;\r\n  size: number;\r\n  uploadDate: string;\r\n  isDeleted: boolean;\r\n}\r\n\r\nexport default function DashboardPage() {\r\n  const userId = 1; // Baad mein login se aayega\r\n\r\n  const [user, setUser] = useState<User | null>(null);\r\n  const [files, setFiles] = useState<FileRecord[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [uploading, setUploading] = useState(false);\r\n\r\n  // Upload form\r\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\r\n  const [fileName, setFileName] = useState('');\r\n  const [fileType, setFileType] = useState('');\r\n\r\n  const API_BASE = 'https://localhost:7192/api/File'; // Tumhara API base URL\r\n\r\n  // Fetch User + Files\r\n  useEffect(() => {\r\n    fetchUser();\r\n    fetchFiles();\r\n  }, []);\r\n\r\n  const fetchUser = async () => {\r\n    try {\r\n      const res = await fetch('https://localhost:7192/api/users/1');\r\n      if (res.ok) {\r\n        const data = await res.json();\r\n        setUser(data);\r\n      }\r\n    } catch (err) {\r\n      console.error(\"User fetch failed\", err);\r\n    }\r\n  };\r\n\r\n  const fetchFiles = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const res = await fetch(`${API_BASE}/user/${userId}`);\r\n      if (res.ok) {\r\n        const data = await res.json();\r\n        setFiles(data.filter((f: FileRecord) => !f.isDeleted));\r\n      }\r\n    } catch (err) {\r\n      toast.error('Failed to load files');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Upload File\r\n  const handleUpload = async () => {\r\n    if (!selectedFile || !fileName || !fileType) {\r\n      toast.error('Please fill all fields');\r\n      return;\r\n    }\r\n\r\n    const formData = new FormData();\r\n    formData.append('userId', userId.toString());\r\n    formData.append('file', selectedFile);\r\n\r\n    try {\r\n      setUploading(true);\r\n      const res = await fetch(`${API_BASE}/upload`, {\r\n        method: 'POST',\r\n        body: formData,\r\n      });\r\n\r\n      if (res.ok) {\r\n        const result = await res.json();\r\n        toast.success('File uploaded successfully!');\r\n        setSelectedFile(null);\r\n        setFileName('');\r\n        setFileType('');\r\n        document.getElementById('fileInput')?.click(); // reset input\r\n        fetchFiles(); // refresh list\r\n      } else {\r\n        toast.error('Upload failed');\r\n      }\r\n    } catch (err) {\r\n      toast.error('Upload error');\r\n    } finally {\r\n      setUploading(false);\r\n    }\r\n  };\r\n\r\n  // Delete File\r\n  const handleDelete = async (fileId: number) => {\r\n    if (!confirm('Are you sure you want to delete this file?')) return;\r\n\r\n    try {\r\n      const res = await fetch(`${API_BASE}/${fileId}`, { method: 'DELETE' });\r\n      if (res.ok) {\r\n        toast.success('File deleted');\r\n        setFiles(files.filter(f => f.id !== fileId));\r\n      } else {\r\n        toast.error('Delete failed');\r\n      }\r\n    } catch (err) {\r\n      toast.error('Network error');\r\n    }\r\n  };\r\n\r\n  // View / Download File\r\n  const handleView = (storedFileName: string, originalName: string) => {\r\n    const url = `https://localhost:7256/uploads/${userId}/${storedFileName}`;\r\n    window.open(url, '_blank');\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\r\n        <Loader2 className=\"w-12 h-12 animate-spin text-blue-600\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Toaster position=\"top-right\" />\r\n      <div className=\"min-h-screen bg-gray-50\">\r\n        {/* Header */}\r\n        <header className=\"bg-blue-700 text-white py-4 shadow-lg\">\r\n          <div className=\"max-w-7xl mx-auto px-6 flex items-center justify-between\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <div className=\"bg-white rounded-lg p-2\">\r\n                <h1 className=\"text-2xl font-bold text-blue-700\">hfiles.</h1>\r\n              </div>\r\n            </div>\r\n            <div className=\"flex items-center gap-4\">\r\n              <span className=\"text-sm\">Welcome back, {user?.fullName}!</span>\r\n              <div className=\"w-10 h-10 rounded-full overflow-hidden border-2 border-white\">\r\n                <Image\r\n                  src={user?.profileImageUrl || \"/api/placeholder/40/40\"}\r\n                  alt=\"User\"\r\n                  width={40}\r\n                  height={40}\r\n                  className=\"object-cover\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </header>\r\n\r\n        <div className=\"max-w-7xl mx-auto px-6 py-12\">\r\n          <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-10\">\r\n\r\n            {/* Profile */}\r\n            <div className=\"lg:col-span-1\">\r\n              <div className=\"bg-white rounded-2xl shadow-lg p-8 border border-gray-100 text-center\">\r\n                <div className=\"w-32 h-32 mx-auto rounded-full overflow-hidden border-4 border-blue-100 mb-4\">\r\n                  <Image\r\n                    src={user?.profileImageUrl || \"/api/placeholder/128/128\"}\r\n                    alt=\"Profile\"\r\n                    width={128}\r\n                    height={128}\r\n                    className=\"object-cover\"\r\n                  />\r\n                </div>\r\n                <h2 className=\"text-2xl font-bold\">{user?.fullName}</h2>\r\n                <p className=\"text-gray-600\">{user?.email}</p>\r\n                <p className=\"text-sm text-gray-500 mt-2\">ID: {userId}</p>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Upload & Files */}\r\n            <div className=\"lg:col-span-2 space-y-8\">\r\n\r\n              {/* Upload Form */}\r\n              <div className=\"bg-white rounded-2xl shadow-lg p-8 border border-gray-100\">\r\n                <h2 className=\"text-xl font-bold mb-6 flex items-center gap-2\">\r\n                  <Upload className=\"w-6 h-6 text-blue-600\" />\r\n                  Upload Medical Record\r\n                </h2>\r\n\r\n                <div className=\"space-y-4\">\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                    <select\r\n                      value={fileType}\r\n                      onChange={(e) => setFileType(e.target.value)}\r\n                      className=\"px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500\"\r\n                    >\r\n                      <option value=\"\">Select Type</option>\r\n                      <option>Lab Report</option>\r\n                      <option>Prescription</option>\r\n                      <option>X-Ray</option>\r\n                      <option>Discharge Summary</option>\r\n                      <option>Other</option>\r\n                    </select>\r\n\r\n                    <input\r\n                      type=\"text\"\r\n                      value={fileName}\r\n                      onChange={(e) => setFileName(e.target.value)}\r\n                      placeholder=\"Enter file name (e.g. Blood Test Jan 2025)\"\r\n                      className=\"px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500\"\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"flex items-center gap-4\">\r\n                    <input\r\n                      id=\"fileInput\"\r\n                      type=\"file\"\r\n                      onChange={(e) => setSelectedFile(e.target.files?.[0] || null)}\r\n                      className=\"hidden\"\r\n                    />\r\n                    <button\r\n                      onClick={() => document.getElementById('fileInput')?.click()}\r\n                      className=\"px-6 py-3 border-2 border-dashed border-gray-400 rounded-lg hover:border-blue-500 transition flex items-center gap-2\"\r\n                    >\r\n                      <Upload className=\"w-5 h-5\" />\r\n                      {selectedFile ? selectedFile.name : 'Choose File'}\r\n                    </button>\r\n\r\n                    {selectedFile && (\r\n                      <button\r\n                        onClick={() => {\r\n                          setSelectedFile(null);\r\n                          setFileName('');\r\n                          setFileType('');\r\n                        }}\r\n                        className=\"text-red-600 hover:text-red-800\"\r\n                      >\r\n                        <X className=\"w-5 h-5\" />\r\n                      </button>\r\n                    )}\r\n\r\n                    <button\r\n                      onClick={handleUpload}\r\n                      disabled={uploading || !selectedFile || !fileName || !fileType}\r\n                      className=\"px-8 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center gap-2\"\r\n                    >\r\n                      {uploading ? <Loader2 className=\"w-5 h-5 animate-spin\" /> : 'Upload'}\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Files List */}\r\n              <div className=\"bg-white rounded-2xl shadow-lg p-8 border border-gray-100\">\r\n                <h3 className=\"text-lg font-semibold mb-4\">Your Medical Records</h3>\r\n\r\n                {files.length === 0 ? (\r\n                  <p className=\"text-center text-gray-500 py-12\">No files uploaded yet.</p>\r\n                ) : (\r\n                  <div className=\"space-y-4\">\r\n                    {files.map((file) => (\r\n                      <div key={file.id} className=\"flex items-center justify-between p-5 border rounded-xl hover:shadow-md transition\">\r\n                        <div className=\"flex items-center gap-4\">\r\n                          <div className=\"bg-gray-100 p-3 rounded-lg\">\r\n                            <FileText className=\"w-8 h-8 text-blue-600\" />\r\n                          </div>\r\n                          <div>\r\n                            <h4 className=\"font-semibold\">{file.fileName}</h4>\r\n                            <p className=\"text-sm text-gray-500\">\r\n                              {file.fileType} â€¢ {(file.size / 1024 / 1024).toFixed(2)} MB\r\n                            </p>\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"flex gap-3\">\r\n                          <button\r\n                            onClick={() => handleView(file.storedFileName, file.fileName)}\r\n                            className=\"px-4 py-2 bg-yellow-400 hover:bg-yellow-500 text-black rounded-lg text-sm flex items-center gap-2\"\r\n                          >\r\n                            <Eye className=\"w-4 h-4\" />\r\n                            View\r\n                          </button>\r\n                          <button\r\n                            onClick={() => handleDelete(file.id)}\r\n                            className=\"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg text-sm flex items-center gap-2\"\r\n                          >\r\n                            <Trash2 className=\"w-4 h-4\" />\r\n                            Delete\r\n                          </button>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}"],"names":[],"mappings":"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"}}]
}